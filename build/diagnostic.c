#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f diagnostic.sh 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[1]))
	"\166\012\215\361\314\351\061\336\343\061\015\215\077\025\140\173"
	"\337\210\031\055\130\125\262"
#define      pswd_z	256
#define      pswd	((&data[75]))
	"\105\247\113\244\232\056\063\207\253\212\016\345\272\237\214\047"
	"\361\317\211\151\205\060\315\052\246\046\177\131\054\120\014\161"
	"\367\130\025\221\206\111\030\062\324\047\027\216\307\243\266\271"
	"\163\077\043\370\017\202\054\035\314\014\061\323\326\143\375\301"
	"\204\346\327\050\102\205\063\224\056\316\026\347\370\023\243\103"
	"\043\120\374\063\322\051\120\237\065\202\162\013\346\157\314\153"
	"\126\244\224\230\051\307\055\127\226\103\077\216\127\343\322\173"
	"\063\316\256\006\367\377\245\054\202\027\070\150\207\005\323\335"
	"\251\147\166\323\057\243\052\305\347\152\124\077\115\046\272\200"
	"\364\151\206\354\151\054\031\353\103\122\123\313\127\047\251\001"
	"\217\037\325\276\303\377\203\253\152\327\352\267\375\245\067\362"
	"\016\276\337\170\352\370\143\056\112\267\371\242\336\242\243\155"
	"\302\170\053\206\170\257\061\343\207\034\232\205\301\322\167\320"
	"\220\127\110\173\117\253\251\231\142\243\074\101\106\337\257\011"
	"\130\333\217\321\213\301\264\022\335\117\227\237\041\017\157\262"
	"\146\270\055\265\143\327\117\306\173\213\010\301\153\267\313\304"
	"\223\132\226\036\034\113\060\372\232\310\231\273\327\011\155\076"
	"\301\233\364\045\163\104\354\356\320\364\260\074\254\173\001\100"
	"\326\227\136\363\343\217\355\175\127\207\071\057\220\247\155\122"
	"\102\142\167\266\157\360\043\026\027\243\157\104\363\174\265\352"
	"\324\313\174\133\025\225\215\351\275\244\167\204\110\055\075\274"
	"\155\140\264\335\121\330\363\151\173\143\255\156\340\143\131\265"
	"\057"
#define      text_z	3877
#define      text	((&data[438]))
	"\153\236\055\050\103\245\254\213\322\352\107\100\112\374\035\234"
	"\325\021\005\120\165\263\277\125\026\031\012\106\357\033\212\132"
	"\271\270\202\374\136\056\207\060\030\317\161\143\314\216\000\242"
	"\240\005\362\025\271\262\152\317\313\165\025\272\220\240\075\156"
	"\153\134\004\055\120\256\342\120\125\220\073\246\021\064\151\120"
	"\045\374\105\357\103\236\233\225\261\131\375\224\156\114\305\074"
	"\053\300\213\363\115\152\376\337\307\162\011\145\337\167\165\031"
	"\125\347\025\355\027\200\306\323\376\173\127\321\255\137\203\047"
	"\014\017\367\016\372\210\172\371\166\013\353\137\275\345\150\344"
	"\267\060\103\243\222\217\013\224\304\350\104\330\331\176\303\312"
	"\152\360\122\224\303\056\061\053\161\126\061\151\253\275\023\143"
	"\213\211\124\024\013\016\006\166\311\205\160\124\213\103\121\006"
	"\275\111\105\375\033\155\117\256\231\114\305\074\350\001\113\053"
	"\011\217\330\236\240\173\140\335\312\152\313\102\310\373\004\026"
	"\147\151\020\276\207\341\340\272\314\273\340\004\022\023\264\174"
	"\277\073\143\270\303\132\137\363\231\350\362\007\127\146\037\044"
	"\005\047\165\077\325\105\132\157\005\263\207\322\366\175\214\024"
	"\065\277\134\243\137\030\062\264\127\226\270\060\310\370\030\352"
	"\350\036\322\363\110\172\313\025\173\066\150\266\335\217\115\043"
	"\212\371\272\037\177\121\026\101\277\253\372\265\054\373\304\317"
	"\207\034\362\357\213\017\167\261\311\010\217\304\020\111\040\352"
	"\354\246\243\357\117\236\146\322\111\345\212\122\156\111\110\066"
	"\226\057\262\357\375\140\131\175\370\211\201\176\265\161\214\233"
	"\027\217\146\361\372\110\256\166\050\311\077\061\322\015\141\225"
	"\302\076\131\203\061\063\061\066\064\176\001\227\122\304\270\004"
	"\277\266\273\363\006\046\076\151\023\146\037\043\255\326\136\215"
	"\311\262\220\301\255\134\332\367\065\121\143\057\077\161\060\101"
	"\076\160\174\164\304\205\254\305\134\044\133\340\241\326\333\220"
	"\123\306\207\211\334\176\071\250\205\321\356\025\302\132\072\264"
	"\273\267\072\015\256\207\353\313\320\072\102\236\046\162\021\122"
	"\360\004\364\310\221\274\322\042\271\356\021\342\134\360\325\117"
	"\176\200\260\127\250\240\104\231\365\204\150\255\304\076\360\330"
	"\022\232\147\362\176\041\103\226\124\227\141\143\227\333\026\062"
	"\307\153\200\270\026\051\221\264\337\255\101\274\215\140\362\010"
	"\000\302\147\027\021\256\272\356\101\341\341\256\042\141\147\361"
	"\113\331\334\301\123\114\161\125\275\307\203\161\107\053\303\302"
	"\073\320\131\017\236\373\373\326\115\112\117\146\353\076\117\110"
	"\107\212\033\237\375\132\265\216\250\111\351\020\031\031\257\333"
	"\334\021\002\350\330\212\126\063\320\023\147\262\341\120\263\025"
	"\337\075\222\173\036\270\032\160\364\204\342\241\372\126\220\061"
	"\152\252\014\004\217\037\213\133\254\106\234\310\322\041\110\036"
	"\120\203\024\134\074\117\330\024\037\234\302\361\120\006\277\353"
	"\047\336\330\062\116\313\077\215\024\156\142\315\247\213\275\360"
	"\030\301\111\254\176\262\011\223\233\017\223\152\204\255\345\251"
	"\335\217\337\205\122\003\000\247\162\221\327\336\052\164\367\240"
	"\062\110\335\073\312\260\017\321\142\355\005\241\070\365\250\330"
	"\271\335\146\163\165\134\276\246\102\072\154\173\130\233\205\133"
	"\050\010\226\174\321\165\237\176\252\061\304\214\264\072\104\011"
	"\315\022\163\254\007\376\315\040\243\277\323\211\342\270\176\207"
	"\076\310\324\073\255\004\130\261\001\267\152\275\120\202\134\221"
	"\201\240\311\245\036\206\157\227\323\125\040\110\214\136\113\304"
	"\252\306\160\345\065\044\142\274\012\344\366\146\354\111\043\045"
	"\341\110\017\127\016\361\264\276\213\321\013\144\313\142\376\014"
	"\037\011\211\360\147\235\116\212\145\106\074\062\153\246\135\362"
	"\212\351\142\351\015\157\327\302\076\302\240\252\163\306\207\362"
	"\006\001\353\351\214\021\211\233\112\242\056\042\102\266\300\052"
	"\175\057\117\050\021\135\071\251\271\106\367\242\016\270\000\226"
	"\170\365\000\163\175\174\172\354\031\063\237\330\243\233\063\046"
	"\242\231\370\264\056\370\214\230\062\164\204\341\346\271\117\130"
	"\141\172\220\065\332\056\317\314\152\245\146\250\010\156\263\163"
	"\272\035\165\245\310\142\026\316\271\102\143\212\000\243\317\047"
	"\301\063\147\266\035\016\210\232\326\254\301\102\160\367\207\100"
	"\106\100\011\250\267\241\064\167\102\101\206\043\063\240\150\076"
	"\345\366\144\340\062\265\364\000\262\036\110\061\051\314\141\161"
	"\231\304\102\304\117\301\246\005\007\334\234\172\175\040\043\066"
	"\176\153\120\170\275\355\006\140\152\307\061\351\300\341\304\040"
	"\303\244\072\161\252\001\112\043\215\273\263\022\224\373\141\342"
	"\321\265\011\034\163\250\145\250\137\027\155\241\246\213\331\376"
	"\055\132\030\326\321\047\377\230\240\043\267\146\213\066\356\325"
	"\157\147\172\064\035\340\366\202\235\031\223\177\162\241\326\061"
	"\221\034\351\276\172\214\031\023\002\066\116\177\274\342\145\364"
	"\221\236\253\272\114\117\240\316\154\070\136\234\036\053\311\024"
	"\367\155\216\324\003\230\265\061\232\060\110\047\200\153\003\144"
	"\113\346\066\330\322\132\073\052\365\034\101\273\310\003\102\075"
	"\067\351\277\376\173\160\176\245\163\105\152\242\276\260\327\331"
	"\157\113\345\273\131\126\116\375\033\273\160\376\245\204\235\310"
	"\034\160\346\241\222\332\316\141\010\151\016\024\171\040\371\163"
	"\337\306\305\264\005\126\231\057\032\252\030\262\353\211\173\140"
	"\327\227\312\147\040\200\376\202\223\334\303\362\062\126\306\337"
	"\313\112\377\140\116\345\104\303\154\307\311\376\105\176\311\103"
	"\343\260\130\061\254\111\364\226\175\113\070\013\122\024\126\056"
	"\206\202\123\271\162\324\216\117\260\054\347\055\323\031\233\205"
	"\077\305\175\022\350\377\045\153\251\337\135\176\343\173\315\310"
	"\273\154\371\200\242\227\131\130\362\316\245\011\105\237\052\160"
	"\226\307\375\267\116\152\204\236\211\202\156\073\067\046\070\262"
	"\101\173\055\044\105\364\250\134\167\237\211\167\216\234\241\110"
	"\317\013\333\260\275\304\035\372\041\212\236\134\206\073\045\115"
	"\267\340\304\154\067\160\071\000\061\262\072\225\237\116\011\045"
	"\103\321\032\042\147\003\062\037\066\146\337\153\352\217\314\273"
	"\027\235\035\126\255\037\333\135\106\170\247\320\117\045\063\205"
	"\304\311\377\325\046\134\121\110\152\150\352\036\166\063\244\315"
	"\032\237\231\220\165\063\301\065\242\321\154\115\315\144\071\203"
	"\210\350\372\064\156\005\041\102\117\017\127\356\007\133\375\346"
	"\335\337\076\325\220\023\300\377\373\241\161\247\204\055\110\256"
	"\216\273\020\313\114\237\051\202\367\041\367\015\317\252\364\250"
	"\305\110\335\165\115\325\020\366\177\024\135\130\222\334\000\066"
	"\021\146\111\154\352\014\065\046\205\351\177\132\245\171\137\160"
	"\127\375\154\120\203\255\104\372\027\065\362\145\056\133\016\104"
	"\366\021\112\315\324\021\152\371\230\060\320\372\112\014\276\256"
	"\130\035\215\224\233\350\221\153\201\341\173\305\356\333\051\237"
	"\010\307\314\234\367\036\024\235\243\144\120\054\077\041\250\212"
	"\006\063\326\001\327\110\312\313\102\223\305\302\251\101\260\300"
	"\007\112\376\375\035\122\113\342\020\031\346\016\004\240\356\356"
	"\107\017\224\306\017\055\136\266\222\227\374\246\177\165\062\271"
	"\011\362\017\013\277\245\352\352\250\361\030\136\252\050\013\003"
	"\356\361\307\376\275\221\111\257\115\052\154\151\241\221\124\107"
	"\332\132\364\113\170\111\035\110\165\313\056\321\010\273\232\015"
	"\251\255\066\140\137\371\264\077\001\047\375\260\272\007\042\174"
	"\014\202\267\075\052\137\325\105\155\002\323\267\011\364\042\166"
	"\067\345\132\347\314\005\074\073\016\150\250\115\325\367\125\303"
	"\137\201\364\117\301\105\377\070\005\144\041\251\264\252\125\315"
	"\016\155\331\153\016\101\014\171\211\230\216\274\352\273\010\235"
	"\120\071\213\377\152\005\011\070\004\315\306\013\121\003\225\015"
	"\060\307\206\163\006\134\175\135\076\361\352\317\037\051\045\237"
	"\225\352\161\311\321\117\243\370\344\125\346\370\013\165\330\376"
	"\065\171\224\210\145\130\116\252\122\073\206\164\033\323\111\113"
	"\247\037\306\010\220\323\343\365\247\333\276\375\206\023\202\004"
	"\174\233\061\361\362\076\122\040\100\116\206\057\275\051\076\160"
	"\056\157\262\073\111\207\157\343\105\127\124\227\026\370\357\100"
	"\155\027\330\077\137\044\162\166\161\247\043\330\177\317\241\105"
	"\252\210\272\322\033\250\321\227\363\207\362\352\374\242\002\017"
	"\270\245\207\061\156\072\162\326\224\003\352\136\322\160\027\031"
	"\373\156\160\074\332\225\332\213\113\353\247\317\107\324\244\344"
	"\366\127\157\124\173\057\102\101\216\347\367\254\230\370\326\356"
	"\140\031\170\057\235\262\073\252\342\053\151\334\334\114\163\315"
	"\331\143\246\177\355\264\237\054\064\312\155\077\205\300\247\050"
	"\251\054\273\355\335\112\255\275\077\366\331\321\143\315\006\062"
	"\234\277\134\273\175\221\310\127\260\007\034\130\002\141\365\317"
	"\307\354\166\121\007\075\366\047\111\120\071\076\357\371\262\004"
	"\050\217\325\313\374\365\212\334\044\335\257\105\206\243\227\225"
	"\223\275\000\343\061\055\353\014\347\234\312\262\012\276\161\357"
	"\174\061\005\364\122\322\045\265\022\312\075\260\263\264\357\137"
	"\213\375\274\203\236\321\176\062\111\140\311\347\074\147\314\342"
	"\126\227\204\030\355\210\201\327\040\063\021\237\013\317\010\053"
	"\112\216\342\310\043\026\140\371\371\332\303\036\003\022\216\366"
	"\260\003\226\116\152\153\037\246\114\214\147\262\202\050\375\104"
	"\312\152\167\022\315\070\325\112\365\367\065\073\064\061\061\362"
	"\242\373\252\070\025\071\225\335\350\037\373\167\365\171\132\142"
	"\155\132\211\175\152\230\160\354\073\351\334\256\132\073\013\260"
	"\246\361\057\316\140\210\157\105\121\215\237\342\321\266\077\172"
	"\162\120\147\073\231\124\074\323\210\151\242\037\027\066\026\047"
	"\322\364\213\034\073\121\352\002\175\254\362\125\360\075\252\147"
	"\332\165\277\232\247\170\000\352\076\330\017\360\065\227\044\312"
	"\027\005\317\373\377\041\122\337\350\343\111\326\224\301\220\374"
	"\221\374\242\151\015\204\234\237\031\050\103\303\374\246\147\201"
	"\123\040\305\332\306\145\113\225\310\067\344\167\336\356\266\060"
	"\326\047\360\070\343\253\014\272\057\245\266\031\243\227\324\020"
	"\030\222\151\214\107\315\327\175\027\351\177\004\012\146\021\040"
	"\102\265\363\314\307\313\274\043\356\131\231\300\245\110\354\233"
	"\000\303\030\070\163\106\127\332\373\144\223\135\117\063\354\371"
	"\000\215\234\372\176\125\001\267\033\377\207\314\322\046\336\062"
	"\021\027\252\020\146\220\276\202\254\215\374\120\272\346\311\046"
	"\214\260\334\351\166\071\063\250\234\075\377\117\063\076\001\046"
	"\353\141\320\276\324\323\105\077\364\275\067\143\232\162\001\255"
	"\106\373\334\301\312\230\176\360\223\337\112\051\242\113\232\125"
	"\316\247\303\245\043\121\126\044\363\012\270\100\152\076\166\322"
	"\260\325\351\036\170\173\047\321\221\175\053\375\365\263\030\176"
	"\327\225\061\212\317\210\176\024\364\260\330\262\152\200\304\237"
	"\156\007\035\050\372\340\374\303\077\134\341\161\160\276\011\212"
	"\200\214\001\300\013\071\271\003\266\101\216\357\300\005\376\330"
	"\014\260\076\141\002\053\262\220\004\200\173\061\016\327\010\166"
	"\325\204\375\023\177\342\061\315\274\352\050\000\072\242\272\213"
	"\115\344\222\033\070\377\244\032\133\246\022\332\300\111\023\105"
	"\375\011\250\175\141\101\037\121\012\024\103\377\121\075\232\101"
	"\254\323\100\154\133\056\173\230\373\103\142\237\212\046\066\210"
	"\134\263\233\136\316\117\203\040\042\223\303\073\256\217\011\263"
	"\353\064\331\265\160\051\073\174\104\345\107\221\042\242\365\173"
	"\067\107\127\043\373\364\023\264\151\271\153\160\320\006\173\364"
	"\022\122\123\345\210\313\167\022\256\222\301\300\071\247\147\060"
	"\276\002\247\101\355\145\062\355\041\256\024\367\350\324\002\011"
	"\236\162\156\236\152\371\041\107\151\307\314\112\162\130\357\264"
	"\257\307\262\021\252\060\370\333\163\325\210\251\137\063\361\346"
	"\372\200\332\322\017\111\204\020\322\305\243\214\160\355\314\342"
	"\054\103\362\112\312\377\230\060\046\150\061\044\014\151\336\220"
	"\066\335\133\202\074\060\372\330\143\002\324\363\344\031\226\317"
	"\254\173\135\331\317\253\302\147\065\331\054\244\116\376\346\121"
	"\243\372\154\067\104\051\360\176\342\017\224\062\255\321\264\050"
	"\053\064\001\304\237\264\360\342\130\064\066\127\067\200\233\163"
	"\020\123\246\147\216\064\003\204\005\215\057\263\077\225\214\365"
	"\233\204\312\017\336\066\327\257\146\356\154\253\030\151\013\374"
	"\332\121\271\005\173\130\340\164\011\317\335\373\175\264\153\275"
	"\242\262\346\355\322\023\361\011\110\165\140\236\053\353\000\275"
	"\351\216\355\251\162\352\325\341\321\370\341\206\067\346\101\220"
	"\373\054\046\066\000\275\255\066\046\154\025\125\361\035\106\203"
	"\147\042\050\363\233\200\056\273\215\002\364\023\160\250\015\324"
	"\057\077\306\340\365\255\033\036\073\103\042\117\150\113\215\365"
	"\220\300\071\113\270\213\057\210\067\251\250\377\300\302\357\045"
	"\136\266\310\117\305\256\000\206\324\300\112\341\276\357\000\060"
	"\220\234\310\202\255\335\047\236\326\307\023\101\315\102\317\334"
	"\150\150\177\355\100\154\162\105\317\246\374\204\263\134\237\114"
	"\266\100\324\350\030\325\170\051\027\031\336\365\036\234\165\205"
	"\010\322\273\023\373\251\140\314\256\202\002\052\220\253\117\110"
	"\305\361\207\132\122\075\263\175\123\363\043\013\257\036\353\333"
	"\324\340\053\024\300\215\331\304\105\137\043\351\135\321\371\044"
	"\162\301\233\022\165\124\244\310\101\202\124\005\124\036\240\122"
	"\017\007\244\357\007\036\140\120\136\274\232\315\252\144\051\337"
	"\220\315\075\156\041\006\113\042\031\236\171\206\314\344\153\226"
	"\126\167\323\036\037\110\211\352\333\210\035\011\373\221\166\072"
	"\265\147\130\124\310\207\352\023\100\014\120\151\217\056\000\026"
	"\072\317\366\015\021\345\076\314\343\335\063\354\161\053\130\313"
	"\110\241\015\170\260\347\341\057\016\177\020\065\160\231\057\256"
	"\115\103\112\300\274\323\204\217\120\167\162\030\273\377\335\053"
	"\307\227\314\125\331\024\247\367\106\061\334\021\144\253\354\272"
	"\063\360\142\334\173\140\215\350\052\124\062\120\036\234\361\065"
	"\166\355\010\140\145\116\054\372\170\310\064\204\355\265\114\266"
	"\006\152\260\277\334\370\071\024\132\366\076\216\110\164\021\070"
	"\316\145\310\250\227\123\002\066\162\044\100\225\030\050\066\257"
	"\127\047\162\017\275\354\361\032\265\330\206\327\116\046\203\100"
	"\030\350\116\120\332\227\116\372\022\377\240\046\055\353\034\264"
	"\101\111\245\166\047\053\027\333\143\254\016\060\156\361\160\055"
	"\221\305\256\270\306\177\300\057\160\163\106\007\145\046\022\170"
	"\133\160\264\054\031\234\150\376\270\217\366\140\373\214\372\350"
	"\142\066\376\014\311\163\033\342\332\204\206\241\370\333\106\175"
	"\225\127\267\146\301\345\104\132\121\220\377\006\224\045\242\345"
	"\305\057\070\365\106\223\073\367\103\375\177\073\332\105\004\120"
	"\311\013\345\042\207\154\356\133\322\126\140\350\303\000\312\260"
	"\076\353\116\370\353\330\172\160\325\121\376\257\301\240\007\133"
	"\013\273\357\304\251\166\234\015\305\006\205\312\003\024\144\037"
	"\301\333\104\305\137\221\131\023\242\305\126\220\137\072\340\254"
	"\156\115\231\173\024\271\202\372\320\105\324\024\212\070\310\132"
	"\241\210\310\040\031\377\113\121\030\174\172\144\315\113\213\133"
	"\143\377\173\064\055\005\362\063\326\100\330\123\055\015\214\237"
	"\065\054\375\122\222\321\352\225\264\257\264\215\235\304\335\065"
	"\005\265\376\262\336\331\256\363\364\320\175\176\334\072\353\326"
	"\322\371\354\270\232\351\022\117\132\310\351\333\216\322\056\301"
	"\365\026\346\150\311\063\046\174\176\131\253\365\334\233\135\050"
	"\164\135\355\007\134\237\262\013\130\305\222\263\204\170\064\103"
	"\031\022\126\055\054\257\314\104\327\266\347\322\073\012\307\110"
	"\237\006\313\320\040\267\072\023\163\170\127\141\333\063\035\147"
	"\227\050\207\224\122\063\000\303\135\103\042\101\221\346\172\116"
	"\024\366\055\372\140\222\337\337\205\350\043\376\161\027\215\310"
	"\255\052\033\303\004\254\061\130\013\073\123\100\376\267\356\155"
	"\322\073\135\065\067\341\371\345\307\112\032\221\333\006\204\234"
	"\375\307\321\010\230\110\056\326\216\063\124\053\252\227\127\352"
	"\324\205\207\320\363\041\040\211\331\130\270\063\255\221\000\370"
	"\254\220\004\024\236\212\155\064\264\352\121\345\020\346\372\313"
	"\005\161\374\234\362\277\072\056\010\036\116\350\022\103\126\345"
	"\113\176\076\140\306\350\221\266\340\371\312\150\302\024\316\375"
	"\254\340\115\244\233\033\031\112\210\225\002\245\266\335\215\071"
	"\120\025\331\273\146\262\125\155\315\306\006\202\142\257\130\030"
	"\144\310\063\143\315\307\204\313\325\165\171\304\152\026\342\354"
	"\006\207\030\356\312\247\364\115\351\175\201\034\004\206\373\377"
	"\275\171\072\267\070\033\155\301\175\122\301\105\163\273\057\206"
	"\034\203\314\047\050\343\230\230\154\043\071\221\337\115\057\267"
	"\165\011\275\077\044\010\266\351\203\047\107\250\252\053\244\116"
	"\326\320\007\347\036\053\142\276\274\113\107\110\116\150\011\365"
	"\157\356\203\024\111\131\227\105\267\306\315\350\337\235\131\102"
	"\152\350\103\014\210\110\377\236\001\261\011\321\174\176\347\067"
	"\017\210\114\131\341\343\237\230\252\155\201\211\012\333\314\165"
	"\303\017\201\114\130\200\352\132\062\364\053\257\163\023\346\202"
	"\233\063\334\175\027\173\026\301\350\227\112\362\162\026\150\066"
	"\046\351\202\176\152\155\330\234\141\004\114\324\027\063\127\263"
	"\146\063\060\175\256\107\076\226\336\210\211\121\237\361\207\305"
	"\333\012\104\106\167\034\342\331\040\057\255\070\142\004\354\310"
	"\067\035\105\346\144\204\174\103\015\006\225\255\370\034\162\323"
	"\047\266\031\236\323\374\167\364\053\045\055\215\052\031\126\142"
	"\066\234\110\233\040\305\337\055\313\164\332\304\221\115\227\270"
	"\004\261\127\327\255\317\314\331\364\371\147\036\022\275\200\111"
	"\131\311\345\171\216\304\247\132\070\202\036\311\320\266\202\324"
	"\147\331\254\025\250\170\356\235\161\126\274\204\023\075\315\154"
	"\006\262\346\225\167\216\360\257\020\016\171\340\304\374\265\054"
	"\325\141\101\176\332\060\034\113\206\330\317\232\026\235\006\035"
	"\120\355\262\307\174\242\167"
#define      chk1_z	22
#define      chk1	((&data[4579]))
	"\155\166\354\042\034\211\061\025\346\304\217\134\136\205\105\222"
	"\100\016\042\125\231\304\047\205\211\342\242\302\204\344\101"
#define      xecc_z	15
#define      xecc	((&data[4606]))
	"\315\366\121\223\131\351\107\302\213\000\300\125\076\353\200\252"
#define      rlax_z	1
#define      rlax	((&data[4622]))
	"\220"
#define      shll_z	10
#define      shll	((&data[4623]))
	"\203\271\161\164\303\147\320\046\077\050"
#define      inlo_z	3
#define      inlo	((&data[4633]))
	"\376\350\212"
#define      date_z	1
#define      date	((&data[4636]))
	"\124"
#define      opts_z	1
#define      opts	((&data[4637]))
	"\115"
#define      lsto_z	1
#define      lsto	((&data[4638]))
	"\237"
#define      tst2_z	19
#define      tst2	((&data[4643]))
	"\303\211\107\110\202\330\332\350\245\363\175\175\162\007\123\131"
	"\273\315\222\051\055\322\105\155\210"
#define      chk2_z	19
#define      chk2	((&data[4666]))
	"\121\036\270\073\026\303\376\007\255\304\035\220\261\240\311\345"
	"\007\244\325\106\052\035\313\123\153"
#define      msg1_z	65
#define      msg1	((&data[4698]))
	"\114\271\362\173\140\261\042\222\042\376\270\045\300\033\001\353"
	"\174\320\245\270\056\250\313\006\215\275\134\014\232\246\067\126"
	"\156\014\043\211\061\274\012\241\263\124\320\024\040\277\361\135"
	"\013\367\132\377\240\306\154\032\132\250\343\001\161\115\260\376"
	"\250\006\114\203\353\356\363\152\123\374\272\063\011\076\366\222"
	"\205\076\000\016\345\202\365\067"
#define      tst1_z	22
#define      tst1	((&data[4777]))
	"\334\350\157\206\232\150\153\162\356\066\200\263\260\063\117\176"
	"\064\103\363\070\212\317"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
